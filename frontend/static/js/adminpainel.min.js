$(function(){function t(t){console.log(t),$("#graphic").remove(),$(".table").remove(),l(),t.details.map(t=>{let e=$("<tr></tr>"),a=$("<td></td>").text(t.id),o=$("<td></td>").text(t.date),l=$("<td></td>").text(t.adress),d=$("<td></td>").text(t.adress_number),c=$("<td></td>").text(t.phone),n=$("<td></td>").text(t.email),r=$("<td></td>").text(t.customer),s=$("<td></td>").text(t.vehicle);e.append(a,o,l,d,c,n,r,s),$("#offerstablebody").append(e)})}function e(t){$("#graphic").remove(),$(".table").remove();let e=$("<div></div>").attr("id","graphic");$("#tables").append(e),Plotly.newPlot("graphic",[t.details],{height:400,width:500})}function a(t){$("#graphic").remove(),$(".table").remove(),function t(){let e=$("<table></table>").addClass("table table-bordered"),a=$("<thead></thead>"),o=$("<tr></tr>"),l=$("<tbody></tbody>").attr("id","customerstablebody"),d=$("<th></th>").text("Id"),c=$("<th></th>").text("Name"),n=$("<th></th>").text("Age"),r=$("<th></th>").text("CPF"),s=$("<th></th>").text("Email"),i=$("<th></th>").text("Password");o.append(d,c,n,r,s,i),a.append(o),e.append(a),e.append(l),$("#tables").append(e)}(),t.details.map(t=>{let e=$("<tr></tr>"),a=$("<td></td>").text(t.id),o=$("<td></td>").text(t.name),l=$("<td></td>").text(t.age),d=$("<td></td>").text(t.cpf),c=$("<td></td>").text(t.email),n=$("<td></td>").text(t.password);e.append(a,o,l,d,c,n),console.log(e),$("#customerstablebody").append(e)})}function o(t){$("#graphic").remove(),$(".table").remove(),function t(){let e=$("<table></table>").addClass("table table-bordered"),a=$("<thead></thead>"),o=$("<tr></tr>"),l=$("<tbody></tbody>").attr("id","vehiclestablebody"),d=$("<th></th>").text("Id"),c=$("<th></th>").text("Name"),n=$("<th></th>").text("Color"),r=$("<th></th>").text("Year"),s=$("<th></th>").text("Mileage"),i=$("<th></th>").text("Engine Capacity"),p=$("<th></th>").text("Price"),h=$("<th></th>").text("Type");o.append(d,c,n,r,s,i,p,h),a.append(o),e.append(a),e.append(l),$("#tables").append(e)}(),t.details.map(t=>{let e=$("<tr></tr>"),a=$("<td></td>").text(t.id),o=$("<td></td>").text(t.name),l=$("<td></td>").text(t.color),d=$("<td></td>").text(t.year),c=$("<td></td>").text(t.mileage+"Km"),n=$("<td></td>").text("car"===t.type?t.engine_capacity+" HP":t.engine_capacity+" CC"),r=$("<td></td>").text(t.price),s=$("<td></td>").text(t.type);e.append(a,o,l,d,c,n,r,s),$("#vehiclestablebody").append(e)})}function l(){let t=$("<table></table>").addClass("table table-bordered"),e=$("<thead></thead>"),a=$("<tr></tr>"),o=$("<tbody></tbody>").attr("id","offerstablebody"),l=$("<th></th>").text("Id"),d=$("<th></th>").text("Date"),c=$("<th></th>").text("Adress"),n=$("<th></th>").text("Adress number"),r=$("<th></th>").text("Phone"),s=$("<th></th>").text("Email"),i=$("<th></th>").text("Customer Id"),p=$("<th></th>").text("Vehicle Id");a.append(l,d,c,n,r,s,i,p),e.append(a),t.append(e),t.append(o),$("#tables").append(t)}$("#queryvehicles").on("click",function(){$.ajax({url:"http://localhost:5000/listVehicles",method:"GET",dataType:"json",success:o,error:function(t){alert("Some error ocourred! backend details: "+t.details)}})}),$("#querycustomers").on("click",function(){$.ajax({url:"http://localhost:5000/listCustomers",method:"GET",dataType:"json",success:a,error:function(t){alert("Some error ocourred! backend details: "+t.details)}})}),$("#querysales").on("click",function(){$.ajax({url:"http://localhost:5000/listSales",method:"GET",dataType:"json",success:e,error:function(t){alert("Some error ocourred! backend details: "+t.details)}})}),$("#queryoffers").on("click",function(){$.ajax({url:"http://localhost:5000/listOffers",method:"GET",dataType:"json",success:t,error:function(t){alert("Some error ocourred! backend details: "+t.details)}})}),$("#sendvehicle").on("click",function(){let t=$("#vehiclename").val(),e=$("#vehiclecolor").val(),a=$("#vehicleyear").val(),o=$("#vehiclemileage").val(),l=$("#vehicleenginecapacity").val(),d=$("#vehicleprice").val(),c=$("#vehicletype").val(),n=$("#vehicleimage").val().substr(12),r=JSON.stringify({name:t,color:e,year:a,mileage:o,engine_capacity:l,price:d,image_name:n});$.ajax({url:"http://localhost:5000/add"+c,method:"POST",dataType:"json",contentType:"application/json",data:r,success:function(t){var e;console.log(t),"ok"==t.result&&(e=new FormData($("#vehicleform")[0]),$.ajax({url:"http://localhost:5000/save_image",method:"POST",data:e,contentType:!1,cache:!1,processData:!1,success:function(t){console.log(t),sendVehicle()},error:function(t){alert("Backend message: "+t.result)}}))},error:function(t){console.log(t),alert("pause2")}})}),$("#sendcustomer").on("click",function(){let t=$("#customername").val(),e=$("#customerage").val(),a=$("#customercpf").val(),o=$("#customeremail").val(),l=$("#customerpassword").val(),d=JSON.stringify({name:t,age:e,cpf:a,email:o,password:l});$.ajax({url:"http://localhost:5000/addCustomer",method:"POST",dataType:"json",contentType:"application/json",data:d,success:function(t){console.log(t)},error:function(t){console.log(t)}})}),$("#sendsale").on("click",function(){let t=$("#salevalue").val(),e=$("#selectcustomer").val(),a=$("#selectemployee").val(),o=$("#selectvehicle").val(),l=JSON.stringify({value:t,customer_id:e,employee_id:a,vehicle_id:o});console.log(l),$.ajax({url:"http://localhost:5000/addSale",method:"POST",dataType:"json",contentType:"application/json",data:l,success:function(t){console.log(t)},error:function(t){console.log(t)}})}),$("#removecustomerbt").on("click",function(){let t=$("#selectcustomer-remove").val();$.ajax({url:"http://localhost:5000/deleteCustomer/"+t,method:"DELETE",success:function(t){console.log(t)},error:function(t){console.log(t)}})}),$("#removevehiclebt").on("click",function(){let t=$("#selectvehicle-remove").val(),e=$("#selectvehicle-remove").find(":selected").attr("rel"),a=e[0].toUpperCase()+e.substring(1);console.log(t),console.log(e),console.log(a),$.ajax({url:`http://localhost:5000/delete${a}/${t}`,method:"DELETE",success:function(t){console.log(t)},error:function(t){console.log(t)}})}),$.ajax({url:"http://localhost:5000/getData",method:"GET",dataType:"json",success:function(t){console.log(t),t.vehicles.map(t=>{$("#selectvehicle").append(`<option value="${t.id}">${t.name}</option>`),$("#selectvehicle-remove").append(`<option rel=${t.type} value="${t.id}">${t.name}</option>`)}),t.employees.map(t=>{$("#selectemployee").append(`<option value="${t.id}">${t.name}</option>`)}),t.customers.map(t=>{$("#selectcustomer").append(`<option value="${t.id}">${t.name}</option>`),$("#selectcustomer-remove").append(`<option value="${t.id}">${t.name}</option>`)}),l(),t.offers.map(t=>{let e=$("<tr></tr>"),a=$("<td></td>").text(t.id),o=$("<td></td>").text(t.date),l=$("<td></td>").text(t.adress),d=$("<td></td>").text(t.adress_number),c=$("<td></td>").text(t.phone),n=$("<td></td>").text(t.email),r=$("<td></td>").text(t.customer),s=$("<td></td>").text(t.vehicle);e.append(a,o,l,d,c,n,r,s),$("#offerstablebody").append(e)})},error:function(){alert("erro")}})});